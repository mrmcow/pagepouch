"use strict";(self.webpackChunk_pagepouch_extension=self.webpackChunk_pagepouch_extension||[]).push([[858],{6858:(e,s,r)=>{r.d(s,{ExtensionAuth:()=>c});var o=r(399),n=r(9907);const a="undefined"!=typeof browser?browser:chrome,t=n.env.SUPABASE_URL||"https://gwvsltgmjreructvbpzg.supabase.co",i=n.env.SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd3dnNsdGdtanJlcnVjdHZicHpnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc3MjY2OTksImV4cCI6MjA3MzMwMjY5OX0.hdq5nlxw5v-zRZ2ZwogvDGzDC3eGZ9u13W0KBfQqeHs",u=(0,o.UU)(t,i);class c{static async signIn(e,s){console.log("🔐 ExtensionAuth.signIn called for:",e),console.log("🔐 Supabase URL:",t);const{data:r,error:o}=await u.auth.signInWithPassword({email:e,password:s});return console.log("🔐 Supabase signIn response:",{hasData:!!r,hasSession:!!r.session,hasUser:!!r.user,hasError:!!o,errorMessage:o?.message}),r.session&&(console.log("🔐 Storing session in chrome storage"),await a.storage.local.set({authToken:r.session.access_token,refreshToken:r.session.refresh_token,userEmail:r.user?.email,userId:r.user?.id})),{data:r,error:o}}static async signUp(e,s,r){const{data:o,error:n}=await u.auth.signUp({email:e,password:s,options:{data:{full_name:r}}});return o.session&&await a.storage.local.set({authToken:o.session.access_token,refreshToken:o.session.refresh_token,userEmail:o.user?.email,userId:o.user?.id}),{data:o,error:n}}static async signOut(){const{error:e}=await u.auth.signOut();return await a.storage.local.remove(["authToken","refreshToken","userEmail","userId"]),{error:e}}static async getSession(){return new Promise(e=>{a.storage.local.get(["authToken","userId"],s=>{e({token:s.authToken||null,userId:s.userId||null})})})}static async refreshSession(){const{refreshToken:e}=await new Promise(e=>{a.storage.local.get(["refreshToken"],s=>{e({refreshToken:s.refreshToken||null})})});if(!e)return{data:null,error:new Error("No refresh token")};const{data:s,error:r}=await u.auth.refreshSession({refresh_token:e});return s.session&&await a.storage.local.set({authToken:s.session.access_token,refreshToken:s.session.refresh_token}),{data:s,error:r}}}}}]);