"use strict";(self.webpackChunk_pagepouch_extension=self.webpackChunk_pagepouch_extension||[]).push([[858],{6858:(e,s,r)=>{r.d(s,{ExtensionAuth:()=>c});var a=r(399),n=r(9907);const o=n.env.SUPABASE_URL||"https://gwvsltgmjreructvbpzg.supabase.co",t=n.env.SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd3dnNsdGdtanJlcnVjdHZicHpnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc3MjY2OTksImV4cCI6MjA3MzMwMjY5OX0.hdq5nlxw5v-zRZ2ZwogvDGzDC3eGZ9u13W0KBfQqeHs",i=(0,a.UU)(o,t);class c{static async signIn(e,s){const{data:r,error:a}=await i.auth.signInWithPassword({email:e,password:s});return r.session&&await chrome.storage.local.set({authToken:r.session.access_token,refreshToken:r.session.refresh_token,userEmail:r.user?.email,userId:r.user?.id}),{data:r,error:a}}static async signUp(e,s,r){const{data:a,error:n}=await i.auth.signUp({email:e,password:s,options:{data:{full_name:r}}});return a.session&&await chrome.storage.local.set({authToken:a.session.access_token,refreshToken:a.session.refresh_token,userEmail:a.user?.email,userId:a.user?.id}),{data:a,error:n}}static async signOut(){const{error:e}=await i.auth.signOut();return await chrome.storage.local.remove(["authToken","refreshToken","userEmail","userId"]),{error:e}}static async getSession(){return new Promise(e=>{chrome.storage.local.get(["authToken","userId"],s=>{e({token:s.authToken||null,userId:s.userId||null})})})}static async refreshSession(){const{refreshToken:e}=await new Promise(e=>{chrome.storage.local.get(["refreshToken"],s=>{e({refreshToken:s.refreshToken||null})})});if(!e)return{data:null,error:new Error("No refresh token")};const{data:s,error:r}=await i.auth.refreshSession({refresh_token:e});return s.session&&await chrome.storage.local.set({authToken:s.session.access_token,refreshToken:s.session.refresh_token}),{data:s,error:r}}}}}]);